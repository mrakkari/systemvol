<!-- Landing Page View -->
<div *ngIf="!hasSearched()" class="bg-slate-800 min-h-screen">
  <!-- Header -->
  <div class="bg-slate-800 px-4 sm:px-6 lg:px-8 py-6">
    <div class="max-w-7xl mx-auto">
      <div class="flex items-center justify-between mb-8">
        <div class="flex items-center">
          <svg class="w-8 h-8 text-white mr-3" fill="currentColor" viewBox="0 0 24 24">
            <path d="M12 2L13.09 8.26L22 9L13.09 9.74L12 16L10.91 9.74L2 9L10.91 8.26L12 2Z"/>
          </svg>
          <span class="text-white text-xl font-bold">Skyscanner</span>
        </div>
        <div class="flex items-center space-x-4 text-white text-sm">
          <span class="cursor-pointer hover:text-blue-300">Help</span>
          <span class="cursor-pointer hover:text-blue-300">üåê</span>
          <span class="cursor-pointer hover:text-blue-300">‚ù§Ô∏è</span>
          <span class="cursor-pointer hover:text-blue-300">üë§</span>
          <span class="cursor-pointer hover:text-blue-300">Log in</span>
        </div>
      </div>
      <!-- Navigation Tabs -->
      <div class="flex space-x-4 mb-8">
        <div class="nav-tab active">
          <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
            <path d="M21 16v-2l-8-5V3.5c0-.83-.67-1.5-1.5-1.5S10 2.67 10 3.5V9l-8 5v2l8-2.5V19l-2 1.5V22l3.5-1 3.5 1v-1.5L13 19v-5.5l8 2.5z"/>
          </svg>
          Flights
        </div>
        <div class="nav-tab inactive">
          <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
            <path d="M7 13c1.66 0 3-1.34 3-3S8.66 7 7 7s-3 1.34-3 3 1.34 3 3 3zm12-6h-8v7H3V6H1v15h2v-3h18v3h2v-9c0-2.21-1.79-4-4-4z"/>
          </svg>
          Hotels
        </div>
        <div class="nav-tab inactive">
          <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
            <path d="M18.92 6.01C18.72 5.42 18.16 5 17.5 5h-11c-.66 0-1.22.42-1.42 1.01L3 12v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8l-2.08-5.99zM6.5 16c-.83 0-1.5-.67-1.5-1.5S5.67 13 6.5 13s1.5.67 1.5 1.5S7.33 16 6.5 16zm11 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zM5 11l1.5-4.5h11L19 11H5z"/>
          </svg>
          Car hire
        </div>
      </div>
      <!-- Main Heading -->
      <div class="mb-12">
        <h1 class="text-4xl md:text-5xl font-bold text-white mb-2">
          Millions of cheap flights. One simple search.
        </h1>
      </div>
      <!-- Trip Type Selector -->
      <div class="mb-6">
        <div class="inline-flex bg-slate-700 rounded-lg p-1">
          <button class="px-4 py-2 rounded-md bg-slate-600 text-white text-sm font-medium">
            Return
            <svg class="w-4 h-4 ml-1 inline" fill="currentColor" viewBox="0 0 24 24">
              <path d="M7 10l5 5 5-5z"/>
            </svg>
          </button>
        </div>
      </div>
      <!-- Search Form -->
      <div class="flex flex-col lg:flex-row gap-4 mb-6 w-full">
        <div class="search-input-group flex-1 min-w-0">
          <div class="search-input-label">From</div>
          <input
            type="text"
            [ngModel]="searchParams().villeDepart"
            (ngModelChange)="updateVilleDepart($event)"
            class="w-full px-4 py-3 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
            placeholder="Country, city or airport"
          />
        </div>
        
        <div class="swap-button lg:block hidden flex-shrink-0 self-end mb-0 mt-auto">
          <div class="bg-white p-2 border border-gray-300 rounded-md flex items-center justify-center">
            <svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l4 4m0 6H4m0 0l4 4m-4-4l4-4"/>
            </svg>
          </div>
        </div>
        
        <div class="search-input-group flex-1 min-w-0">
          <div class="search-input-label">To</div>
          <input
            type="text"
            [ngModel]="searchParams().villeArrivee"
            (ngModelChange)="updateVilleArrivee($event)"
            class="w-full px-4 py-3 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
            placeholder="Country, city or airport"
          />
        </div>
        
        <div class="search-input-group flex-1 min-w-0">
          <div class="search-input-label">Depart</div>
          <button
            type="button"
            class="w-full px-4 py-3 border border-gray-300 rounded-lg text-left text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white"
            (click)="openCalendar('depart')"
          >
            {{ searchParams().dateDepart || 'Depart date' }}
          </button>
        </div>
        
        <div class="search-input-group flex-1 min-w-0">
          <div class="search-input-label">Return</div>
          <button
            type="button"
            class="w-full px-4 py-3 border border-gray-300 rounded-lg text-left text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white"
            (click)="openCalendar('return')"
          >
            {{ searchParams().dateArrivee || 'Add date' }}
          </button>
        </div>
        
        <!-- Tri (Sort) Field -->
        <div class="search-input-group flex-1 min-w-0">
          <div class="search-input-label">Sort by</div>
          <select
            [ngModel]="searchParams().tri || ''"
            (ngModelChange)="updateTriValue($event)"
            class="w-full px-4 py-3 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white"
          >
            <option value="">Best</option>
            <option value="prix">Price</option>
            <option value="temps_trajet">Duration</option>
          </select>
        </div>
        
        <!-- Search Button -->
        <div class="flex-1 min-w-0">
          <button
            type="button"
            class="search-button-full"
            (click)="searchFlights()"
            [disabled]="isLoading() || !isSearchValid()"
          >
            <span *ngIf="!isLoading()" class="w-full text-center">Search</span>
            <span *ngIf="isLoading()" class="flex items-center justify-center w-full">
              <svg class="animate-spin -ml-1 mr-2 h-4 w-4 text-white" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 714 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
              </svg>
              Searching...
            </span>
          </button>
        </div>
      </div>
      <!-- Error Message -->
      <div *ngIf="errorMessage()" class="mb-6 p-4 bg-red-50 border border-red-200 rounded-lg">
        <p class="text-red-600 text-sm">{{ errorMessage() }}</p>
      </div>
      <!-- Additional Options -->
      <div class="flex flex-wrap gap-4 mb-8 text-sm text-white">
        <label class="flex items-center">
          <input type="checkbox" class="mr-2 rounded">
          Add nearby airports
        </label>
        <label class="flex items-center">
          <input type="checkbox" class="mr-2 rounded">
          Add nearby airports
        </label>
        <label class="flex items-center">
          <input type="checkbox" class="mr-2 rounded">
          Direct flights
        </label>
      </div>
      <!-- Price Tracking Banner -->
      <div class="flex items-center justify-between bg-slate-700 rounded-lg p-4">
        <div class="flex items-center text-white">
          <svg class="w-6 h-6 mr-3" fill="currentColor" viewBox="0 0 24 24">
            <path d="M10 2L3 7v11a1 1 0 001 1h3a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1h3a1 1 0 001-1V7l-7-5z"/>
          </svg>
          <span>Access price tracking features to help you save</span>
        </div>
        <button class="bg-white text-slate-800 px-6 py-2 rounded-lg font-medium hover:bg-gray-100 transition-colors">
          Log in
        </button>
      </div>
    </div>
  </div>
  <!-- Hero Section -->
  <div class="relative">
    <div class="hero-background">
      <!-- Background overlay for better text readability -->
      <div class="hero-overlay"></div>
      
      <!-- Content -->
      <div class="hero-content">
        <div class="hero-text">
          <p class="hero-subtitle">Can't decide where to go?</p>
          <h2 class="hero-title">Explore every destination</h2>
          <button class="hero-button">
            Search flights Everywhere
          </button>
        </div>
      </div>
    </div>
  </div>
  <!-- FAQ Section -->
  <div class="bg-white py-16">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <h2 class="text-2xl font-bold text-gray-900 mb-8">Booking flights with Skyscanner</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        <div class="space-y-4">
          <div class="border-b border-gray-200 pb-4">
            <h3 class="font-medium text-gray-900">How does Skyscanner work?</h3>
          </div>
          <div class="border-b border-gray-200 pb-4">
            <h3 class="font-medium text-gray-900">How can I find the cheapest flight using Skyscanner?</h3>
          </div>
          <div class="border-b border-gray-200 pb-4">
            <h3 class="font-medium text-gray-900">Where should I book a flight to right now?</h3>
          </div>
        </div>
        <div class="space-y-4">
          <div class="border-b border-gray-200 pb-4">
            <h3 class="font-medium text-gray-900">Does Skyscanner do hotels too?</h3>
          </div>
          <div class="border-b border-gray-200 pb-4">
            <h3 class="font-medium text-gray-900">What about car hire?</h3>
          </div>
          <div class="border-b border-gray-200 pb-4">
            <h3 class="font-medium text-gray-900">What's a Price Alert?</h3>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Results Page View -->
<div *ngIf="hasSearched()" class="bg-gray-50 min-h-screen">
  <!-- Header with Search Summary -->
  <div class="bg-blue-900 px-4 sm:px-6 lg:px-8 py-4">
    <div class="max-w-7xl mx-auto">
      <div class="flex items-center justify-between">
        <div class="flex items-center">
          <!-- Back Arrow -->
          <button
            (click)="goBack()"
            class="mr-4 p-2 rounded-full hover:bg-blue-800 transition-colors duration-200"
            title="Back to search"
          >
            <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
            </svg>
          </button>
          <div class="bg-blue-600 p-2 rounded mr-4">
            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 24 24">
              <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
            </svg>
          </div>
          <div class="text-white">
            <span class="font-medium">{{ getSearchSummary() }}</span>
          </div>
        </div>
        <div class="flex items-center space-x-4">
          <div class="text-white text-sm">Vos destinations</div>
          <div class="w-8 h-8 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm">
            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 24 24">
              <path d="M8.5 2C5.46 2 3 4.46 3 7.5c0 3.19 5.5 9.5 5.5 9.5s5.5-6.31 5.5-9.5C14 4.46 11.54 2 8.5 2zm0 7C7.67 9 7 8.33 7 7.5S7.67 6 8.5 6 10 6.67 10 7.5 9.33 9 8.5 9z"/>
              <path d="M15.5 6c-2.21 0-4 1.79-4 4 0 2.38 4 7 4 7s4-4.62 4-7c0-2.21-1.79-4-4-4zm0 5.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z" opacity="0.7"/>
            </svg>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
      <!-- Filter Sidebar -->
      <div class="lg:col-span-3">
        <app-filter-sidebar
          (filtersChanged)="applyFilters($event)"
        ></app-filter-sidebar>
      </div>
      <!-- Main Content -->
      <div class="lg:col-span-6">
        <!-- Price Alert and Sort Section -->
        <div class="flex items-center justify-between mb-6">
          <div class="flex items-center">
            <svg class="w-5 h-5 mr-2 text-gray-600" fill="currentColor" viewBox="0 0 20 20">
              <path d="M10 2L3 7v11a1 1 0 001 1h3a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1h3a1 1 0 001-1V7l-7-5z"/>
            </svg>
            <span class="text-sm font-medium text-gray-900 mr-4">Recevoir des alertes prix</span>
            <span class="text-sm text-gray-600">{{ filteredFlights().length }} r√©sultats</span>
          </div>
          <div class="flex items-center">
            <span class="text-sm text-gray-600 mr-2">Trier par</span>
            <select
              [ngModel]="searchParams().tri || ''"
              (ngModelChange)="updateTriValue($event)"
              class="border border-gray-300 rounded-lg p-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
            >
              <option value="">Le meilleur</option>
              <option value="prix">Le moins cher</option>
              <option value="temps_trajet">Le plus rapide</option>
            </select>
          </div>
        </div>
        <!-- Sort Options Cards -->
        <div class="grid grid-cols-3 gap-4 mb-6">
          <div class="bg-blue-900 text-white p-4 rounded-lg text-center">
            <div class="text-sm font-medium mb-1">Le meilleur</div>
            <div class="text-xl font-bold">{{ getHighestPrice() }} ‚Ç¨</div>
            <div class="text-xs opacity-75">{{ formatDuration(getShortestDuration()) }}</div>
          </div>
          <div class="bg-gray-100 p-4 rounded-lg text-center cursor-pointer hover:bg-gray-200">
            <div class="text-sm font-medium text-gray-600 mb-1">Le moins cher</div>
            <div class="text-xl font-bold text-gray-900">{{ getLowestPrice() }} ‚Ç¨</div>
            <div class="text-xs text-gray-500">{{ formatDuration(getShortestDuration()) }}</div>
          </div>
          <div class="bg-gray-100 p-4 rounded-lg text-center cursor-pointer hover:bg-gray-200">
            <div class="text-sm font-medium text-gray-600 mb-1">Le plus rapide</div>
            <div class="text-xl font-bold text-gray-900">{{ getFastestPrice() }} ‚Ç¨</div>
            <div class="text-xs text-gray-500">{{ formatDuration(getShortestDuration()) }}</div>
          </div>
        </div>
        <!-- Flight Cards -->
        <div class="space-y-4" *ngIf="filteredFlights().length > 0">
          <app-flight-reservation-card
            *ngFor="let flight of filteredFlights()"
            [flight]="flight"
            (reserve)="openReservationPopup(flight.id)"
          ></app-flight-reservation-card>
        </div>
        <!-- No Results -->
        <div *ngIf="filteredFlights().length === 0 && !isLoading()" class="text-center py-12">
          <div class="mb-4">
            <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 48 48">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M34 40h10v-4a6 6 0 00-10.712-3.714M34 40H14m20 0v-4a9.971 9.971 0 00-.712-3.714M14 40H4v-4a6 6 0 0110.713-3.714M14 40v-4c0-1.313.253-2.566.713-3.714m0 0A10.003 10.003 0 0124 26c4.21 0 7.813 2.602 9.288 6.286M30 14a6 6 0 11-12 0 6 6 0 0112 0zm12 6a4 4 0 11-8 0 4 4 0 018 0zm-28 0a4 4 0 11-8 0 4 4 0 018 0z"/>
            </svg>
          </div>
          <h3 class="text-lg font-medium text-gray-900 mb-2">Aucun vol trouv√©</h3>
          <p class="text-gray-600">Essayez de modifier vos crit√®res de recherche.</p>
        </div>
      </div>
      <!-- Right Sidebar Content -->
      <div class="lg:col-span-3 space-y-6">
        <!-- Hotel Finder -->
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
          <h3 class="text-lg font-semibold text-gray-900 mb-4">Vous avez trouv√© votre vol ? Trouvez maintenant votre h√¥tel</h3>
          <p class="text-sm text-gray-600 mb-4">Acc√©dez aux r√©sultats des meilleurs sites d'h√¥tels ici, sur Skyscanner.</p>
          <button class="w-full bg-blue-900 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-800 transition-colors">
            D√©couvrir les h√¥tels
          </button>
          <div class="text-xs text-gray-500 mt-2 text-center">ven. 7 mars-sam. 8 mars</div>
        </div>
        <!-- Car Rental -->
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
          <h3 class="text-lg font-semibold text-gray-900 mb-4">Location de voiture √† Djerba</h3>
          <p class="text-sm text-gray-600 mb-4">Ne vous arr√™tez pas aux vols, trouvez √©galement de bonnes affaires sur les v√©hicules.</p>
          <div class="bg-blue-600 rounded-lg p-4 flex items-center justify-between">
            <div class="text-white">
              <div class="text-sm font-medium">Location de voiture d√®s</div>
              <div class="text-lg font-bold">24 ‚Ç¨ par jour</div>
            </div>
            <div class="w-16 h-12 bg-blue-500 rounded flex items-center justify-center">
              <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 24 24">
                <path d="M18.92 6.01C18.72 5.42 18.16 5 17.5 5h-11c-.66 0-1.22.42-1.42 1.01L3 12v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8l-2.08-5.99zM6.5 16c-.83 0-1.5-.67-1.5-1.5S5.67 13 6.5 13s1.5.67 1.5 1.5S7.33 16 6.5 16zm11 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zM5 11l1.5-4.5h11L19 11H5z"/>
              </svg>
            </div>
          </div>
          <button class="w-full mt-4 bg-blue-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center justify-center">
            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
            </svg>
            D√©couvrir
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Reservation Popup -->
<div *ngIf="showReservationPopup() && !reservationSuccess()" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
  <div class="bg-white rounded-lg shadow-xl w-full max-w-md mx-4" (click)="$event.stopPropagation()">
    <!-- Header -->
    <div class="flex items-center justify-between p-6 border-b border-gray-200">
      <h3 class="text-lg font-semibold text-gray-900">R√©servation de vol</h3>
      <button
        (click)="closeReservationPopup()"
        class="text-gray-400 hover:text-gray-600 transition-colors"
      >
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
        </svg>
      </button>
    </div>
    
    <!-- Form -->
    <form (ngSubmit)="submitReservation()" #reservationForm="ngForm" class="p-6 space-y-4">
      <div>
        <label for="nom" class="block text-sm font-medium text-gray-700 mb-1">Nom</label>
        <input
          id="nom"
          name="nom"
          [(ngModel)]="reservationRequest.passager.nom"
          required
          class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
          placeholder="Votre nom"
        />
      </div>
      <div>
        <label for="prenom" class="block text-sm font-medium text-gray-700 mb-1">Pr√©nom</label>
        <input
          id="prenom"
          name="prenom"
          [(ngModel)]="reservationRequest.passager.prenom"
          required
          class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
          placeholder="Votre pr√©nom"
        />
      </div>
      <div>
        <label for="email" class="block text-sm font-medium text-gray-700 mb-1">Email</label>
        <input
          id="email"
          name="email"
          type="email"
          [(ngModel)]="reservationRequest.passager.email"
          required
          class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
          placeholder="votre.email@example.com"
        />
      </div>
      <div>
        <label for="nombrePlaces" class="block text-sm font-medium text-gray-700 mb-1">Nombre de places</label>
        <input
          id="nombrePlaces"
          name="nombrePlaces"
          type="number"
          [(ngModel)]="reservationRequest.nombrePlaces"
          required
          min="1"
          class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
        />
      </div>
      
      <!-- Error Message -->
      <div *ngIf="reservationError()" class="p-3 bg-red-50 border border-red-200 rounded-lg">
        <p class="text-red-600 text-sm">{{ reservationError() }}</p>
      </div>
      
      <!-- Action Buttons -->
      <div class="flex justify-end gap-3 pt-4">
        <button 
          type="button" 
          (click)="closeReservationPopup()" 
          class="px-4 py-2 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors"
        >
          Annuler
        </button>
        <button 
          type="submit" 
          class="px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors font-medium"
          [disabled]="!reservationForm.form.valid"
        >
          Confirmer
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Success Popup -->
<div *ngIf="reservationSuccess() && reservationResponse" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
  <div class="bg-white rounded-lg shadow-xl w-full max-w-lg mx-4" (click)="$event.stopPropagation()">
    <!-- Header -->
    <div class="flex items-center justify-between p-6 border-b border-gray-200">
      <div class="flex items-center">
        <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center mr-3">
          <svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
          </svg>
        </div>
        <h3 class="text-lg font-semibold text-gray-900">R√©servation confirm√©e !</h3>
      </div>
      <button
        (click)="closeReservationPopup()"
        class="text-gray-400 hover:text-gray-600 transition-colors"
      >
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
        </svg>
      </button>
    </div>
    
    <!-- Content -->
    <div class="p-6">
      <!-- Reservation Number -->
      <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-6">
        <div class="text-center">
          <p class="text-sm text-green-600 font-medium mb-1">Num√©ro de r√©servation</p>
          <p class="text-lg font-bold text-green-700">{{ reservationResponse.numeroReservation }}</p>
        </div>
      </div>
      
      <!-- Reservation Details -->
      <div class="space-y-4">
        <h4 class="font-medium text-gray-900 border-b border-gray-200 pb-2">D√©tails de la r√©servation</h4>
        
        <div class="grid grid-cols-2 gap-4 text-sm">
          <div>
            <p class="text-gray-600">Passager</p>
            <p class="font-medium">{{ reservationResponse.passager.nom }} {{ reservationResponse.passager.prenom }}</p>
          </div>
          <div>
            <p class="text-gray-600">Email</p>
            <p class="font-medium">{{ reservationResponse.passager.email }}</p>
          </div>
        </div>
        
        <div class="border-t border-gray-200 pt-4">
          <div class="flex items-center justify-between mb-3">
            <h5 class="font-medium text-gray-900">Vol</h5>
            <span class="text-sm text-gray-500">{{ reservationResponse.nombrePlaces }} {{ reservationResponse.nombrePlaces > 1 ? 'places' : 'place' }}</span>
          </div>
          
          <div class="bg-gray-50 rounded-lg p-4 space-y-2">
            <div class="flex items-center justify-between">
              <div>
                <p class="font-medium">{{ getFlightDetails(reservationResponse.volId)?.villeDepart }} ‚Üí {{ getFlightDetails(reservationResponse.volId)?.villeArrivee }}</p>
                <div class="flex items-center text-sm text-gray-600 mt-1">
                  <span>{{ formatFlightDate(getFlightDetails(reservationResponse.volId)?.dateDepart || '') }}</span>
                  <span class="mx-2">‚Ä¢</span>
                  <span>{{ formatFlightDate(getFlightDetails(reservationResponse.volId)?.dateArrivee || '') }}</span>
                </div>
              </div>
              <div class="text-right">
                <p class="font-bold text-lg">{{ getFlightDetails(reservationResponse.volId)?.prix || 0 }} ‚Ç¨</p>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Confirmation Message -->
      <div class="mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg">
        <p class="text-sm text-blue-800 text-center">
          Un email de confirmation vous sera envoy√© √† <strong>{{ reservationResponse.passager.email }}</strong>
        </p>
      </div>
      
      <!-- Close Button -->
      <div class="flex justify-center mt-6">
        <button 
          (click)="closeReservationPopup()" 
          class="px-8 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors font-medium"
        >
          Fermer
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Calendar Modal -->
<div
  *ngIf="showCalendar()"
  class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center"
  (click)="showCalendar.set(false)"
>
  <div (click)="stopPropagation($event)" class="w-full max-w-md">
    <app-calendar
      [initialDate]="getInitialDate()"
      (dateSelected)="onDateSelected($event)"
      (cancelled)="showCalendar.set(false)"
    ></app-calendar>
  </div>
</div>